import{_ as a,c as i,a2 as e,o as n}from"./chunks/framework.DJJi9g99.js";const t="/How-public-transport-systems-work/interurbanos.jpg",l="/How-public-transport-systems-work/app-1.webp",p="/How-public-transport-systems-work/app-2.webp",o="/How-public-transport-systems-work/crtm.png",r="/How-public-transport-systems-work/crtm2.png",h="/How-public-transport-systems-work/adif.png",k="/How-public-transport-systems-work/adif3.png",d="/How-public-transport-systems-work/abono.png",C=JSON.parse('{"title":"Â¿Como funcionan los sistemas del transporte publico?","description":"Entendiendo los servicios informaticos del transporte publico y sus fracasos","frontmatter":{"title":"Â¿Como funcionan los sistemas del transporte publico?","date":"24/01/2024","description":"Entendiendo los servicios informaticos del transporte publico y sus fracasos"},"headers":[],"relativePath":"blog/how-public-transport-system-work.md","filePath":"blog/how-public-transport-system-work.md","lastUpdated":1728300226000}'),E={name:"blog/how-public-transport-system-work.md"};function u(c,s,g,y,m,F){return n(),i("div",null,s[0]||(s[0]=[e('<h1 id="Â¿como-funcionan-los-sistemas-del-transporte-publico" tabindex="-1">Â¿Como funcionan los sistemas del transporte publico? <a class="header-anchor" href="#Â¿como-funcionan-los-sistemas-del-transporte-publico" aria-label="Permalink to &quot;Â¿Como funcionan los sistemas del transporte publico?&quot;">â€‹</a></h1><p><img src="'+t+'" alt="Interurbanos"></p><p>He usado el transporte publico desde que tenia consciencia, y a decir verdad, me ha ayudado mucho. Pero siempre que espero al bus tengo una duda: <strong>Â¿Cuanto le queda?</strong></p><p>A decir verdad, esta duda fue resuelta hace tiempo por el CRTM (Consorcio Regional de Transportes de Madrid) al crear un servicio que te proporciona los datos de los buses urbanos e interurbanos.</p><p><em>Â¿Pero y si eres de Madrid cAPItal?</em></p><p>Bueno entonces tienes la aplicaciÃ³n de EMT para ver los tiempos.</p><p><em>Â¿Y si prefiero usar el metro?</em></p><p>Para eso esta la aplicaciÃ³n de Metro Madrid.</p><p><em>Â¿Y si tengo que usar el tren?</em></p><p>Te descargas la aplicaciÃ³n de Adif.</p><p><em>Â¿Y si tengo que ver el saldo de mi abono transporte?</em></p><p>Pues la aplicaciÃ³n de Tarjeta Transporte te permite consultarlo.</p><p>Creo que ya lo vais pillando, te tienes que descargar 5 aplicaciÃ³nes diferentes para el transporte publico (solo en la comunidad de Madrid).</p><h2 id="aplicaciones" tabindex="-1">Aplicaciones <a class="header-anchor" href="#aplicaciones" aria-label="Permalink to &quot;Aplicaciones&quot;">â€‹</a></h2><p>Obviamente existen aplicaciÃ³nes que unen todos esos servicios en una sola aplicaciÃ³n, pero <strong>Â¿Como funcionan?</strong></p><p>Pues simplemente haciendo lo que hacen las aplicaciÃ³nes oficiales.</p><h2 id="metodologia" tabindex="-1">Metodologia <a class="header-anchor" href="#metodologia" aria-label="Permalink to &quot;Metodologia&quot;">â€‹</a></h2><p>Para poder ver como funcionan estas aplicaciÃ³nes usare Burp proxy y un movil android con root para poder instalar el certificado de Burp y descifrar el trafico de red.</p><h2 id="crtm" tabindex="-1">CRTM <a class="header-anchor" href="#crtm" aria-label="Permalink to &quot;CRTM&quot;">â€‹</a></h2><p>El consorcio ofrece un SOAP para obtener los datos en tiempo real sobre los autobuses interurbanos y urbanos.</p><h3 id="Â¿cuando-se-hizo-el-servicio" tabindex="-1">Â¿Cuando se hizo el servicio? <a class="header-anchor" href="#Â¿cuando-se-hizo-el-servicio" aria-label="Permalink to &quot;Â¿Cuando se hizo el servicio?&quot;">â€‹</a></h3><p>El servicio se hizo en torno al 2016, que es cuando salio una aplicaciÃ³n llamada <em>Transporte de Madrid CRTM</em> que ofrecia los tiempos de los autobuses en tiempo real, las paradas cercanas, las oficinas de recarga...</p><p>El principal problema es que la aplicaciÃ³n se veia asi:</p><p><img src="'+l+'" alt="Transporte de Madrid CRTM"><img src="'+p+'" alt="Transporte de Madrid CRTM"></p><p>Bastante feo para haberlo hecho en 2016 por la empresa que gestiona el transporte publico de Madrid, Â¿no?</p><p>Bueno, pues la aplicaciÃ³n se acabo borrando de la app store y de la play store. Pero aunque quitasen la aplicaciÃ³n, el servicio seguia funcionando.</p><h3 id="Â¿como-funciona-el-servicio" tabindex="-1">Â¿Como funciona el servicio? <a class="header-anchor" href="#Â¿como-funciona-el-servicio" aria-label="Permalink to &quot;Â¿Como funciona el servicio?&quot;">â€‹</a></h3><p>Si interceptamos las peticiones de la aplicaciÃ³n que una vez fue <em>Transporte de Madrid CRTM</em>, podemos ver esto:</p><p><img src="'+o+'" alt="Transporte de Madrid CRTM"></p><p>y si entramos a la url <a href="http://www.citram.es:8080/WSMultimodalInformation/MultimodalInformation.svc" target="_blank" rel="noreferrer">http://www.citram.es:8080/WSMultimodalInformation/MultimodalInformation.svc</a> pues encontramos el servicio SOAP y con el podemos generar un cliente, pero aun falta la clave privada, que podemos obtener si decompilamos el apk.</p><p><img src="'+r+'" alt="Transporte de Madrid CRTM"></p><h2 id="emt" tabindex="-1">EMT <a class="header-anchor" href="#emt" aria-label="Permalink to &quot;EMT&quot;">â€‹</a></h2><p>La empresa municipal de transportes parece hacerlo algo mejor ya que su API es publica, esta documentada y se actualiza, asi que realmente no hace falta interceptar el trafico.</p><p>Cualquier persona puede consultarla y consumirla: <a href="https://apidocs.emtmadrid.es/" target="_blank" rel="noreferrer">https://apidocs.emtmadrid.es/</a></p><h2 id="metro" tabindex="-1">Metro <a class="header-anchor" href="#metro" aria-label="Permalink to &quot;Metro&quot;">â€‹</a></h2><p>Metro es bastante curioso ya que tiene una aplicaciÃ³n decente pero no hay API publica ðŸ˜ž.</p><p>Pero si que la hay privada.</p><h3 id="Â¿como-funciona-la-api-de-metro" tabindex="-1">Â¿Como funciona la API de metro? <a class="header-anchor" href="#Â¿como-funciona-la-api-de-metro" aria-label="Permalink to &quot;Â¿Como funciona la API de metro?&quot;">â€‹</a></h3><p>Bueno pues la API de metro tampoco tiene mucha cosa, pero si que hay dos endpoints importantes:</p><ul><li>Consultar datos de un abono transporte: <code>POST</code> <a href="https://serviciosapp.metromadrid.es/tarjetapost/login" target="_blank" rel="noreferrer">https://serviciosapp.metromadrid.es/tarjetapost/login</a> con body <code>sNumeroTP=...&amp;version=2</code></li><li>Consultar tiempos de las estaciones: <code>GET</code> <a href="https://serviciosapp.metromadrid.es/servicios/rest/teleindicadores" target="_blank" rel="noreferrer">https://serviciosapp.metromadrid.es/servicios/rest/teleindicadores</a></li></ul><h2 id="tren" tabindex="-1">Tren <a class="header-anchor" href="#tren" aria-label="Permalink to &quot;Tren&quot;">â€‹</a></h2><p>En este caso tampoco hay una API publica pero al igual que metro, si que la hay privada.</p><p>Usando Burp, puedes obtener la &quot;documentacion&quot;.</p><p><img src="'+h+'" alt="Adif"></p><p>La app que provee los datos en este caso es ADIF.</p><p>Por desgracia usan una autorizacion con encriptado HMAC-SHA256, lo que significa que hacer una llamada no es tan simple como poner un token que no cambia, o llamar a una API que nos lo provea.</p><p>Aqui cada llamada tendra un valor u otro segun los headers y esta encriptado con una clave secreta que se puede obtener si decompilamos el apk:</p><p><img src="'+k+`" alt="Adif html"></p><p>pero por alguna razon parece que no quieren que nadie lo use:</p><div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getSignatureKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(str: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, str2: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, str3: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ByteArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> hmacSha256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hmacSha256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hmacSha256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(str.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toByteArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(StandardCharsets.UTF_8), str2), str3), ELCANO_REQUEST)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Â¿Realmente es necesario encriptar lo encriptado de lo encriptado ADIF? ðŸ¤”</p><h2 id="tarjeta-transporte-publico" tabindex="-1">Tarjeta transporte publico <a class="header-anchor" href="#tarjeta-transporte-publico" aria-label="Permalink to &quot;Tarjeta transporte publico&quot;">â€‹</a></h2><p>Para obtener los datos de la tarjeta de transporte publico podemos usar el endpoint de metro, pero eso solo valdria para tarjetas personales, asi que vamos a ver como funciona la aplicaciÃ³n de Tarjeta Transporte.</p><p>De primeras se llama a el endpoint para iniciar la conexion, y se le tiene que pasar una serie de datos:</p><p><img src="`+d+`" alt="Abono"></p><p>A partir de esta respuesta obtenemos una cookie que sera nuestro identificador de sesion.</p><p>El siguiente paso es empezar el proceso de lectura pasando el punto de venta.</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;titleList&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;COMMON&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;salePoint&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;010201000005&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;updateCard&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;commandType&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WRAPPED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;opInspection&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>y esto nos devuelve una serie de comando que debemos pasar a la tarjeta por NFC.</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0010&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;description&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;capdu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;9060000000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;90AF000000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;90AF000000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;905A00000300000100&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;900A0000010200&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;balance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;titleList&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;updateReason&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;uniqueIdTransactionMS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;uniqueIdTransactionLS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>una vez pasados, se debe devolver al servidor las respuestas de la tarjeta:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;titleList&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;COMMON&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;rapdu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;0401010100180591AF&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;0401010104180591AF&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;0454211ADA3B80BA5494BA5024149100&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;9100&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;4FB07C8DC2A8946791AF&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;salePoint&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;010201000005&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;updateCard&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;commandType&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WRAPPED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;opInspection&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>y asi hasta que el servidor nos de el codigo <code>0000</code></p><p>que contendra el saldo y los posibles titulos recargables con sus precios:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;description&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;capdu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;balance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;desfireSerial&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;now&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2024-01-24 01:01:30&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;controlDigit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;00&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;orderCode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;cardOrderNumber&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;initAppDate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2015-11-24&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;finishAppDate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-11-24&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;blockedApp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;groupName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Normal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;groupShortName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Normal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;groupId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;initGroupDate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2015-11-24&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;finishGroupDate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-11-24&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;profiles&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;profileId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;profileName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Normal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;initProfileDate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2015-11-24&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;finishProfileDate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-11-24&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;profileId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;profileName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Joven&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;initProfileDate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2015-11-24&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;finishProfileDate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-11-24&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="Â¿y-ahora" tabindex="-1">Â¿Y ahora? <a class="header-anchor" href="#Â¿y-ahora" aria-label="Permalink to &quot;Â¿Y ahora?&quot;">â€‹</a></h2><p>Bueno pues ahora podemos obtener los tiempos de los transportes y las ubicaciones en el caso de los autobuses. Aunque aun falta lo mas importante, <strong>Las paradas</strong>.</p><p>Â¿Pero de donde sacas la informacion de <strong>todas</strong> las paradas?</p><p>Pues del servicio multimodal <a href="https://datos-movilidad.crtm.es/" target="_blank" rel="noreferrer">https://datos-movilidad.crtm.es/</a>.</p><blockquote><p>Aqui la noticia de 2018 (que ha sido borrada de la pagina principal) <a href="http://web.archive.org/web/20211127182849/https://www.madrid.es/portales/munimadrid/es/Inicio/Medio-ambiente/CIVITAS-ECCENTRIC/Las-11-medidas/Plataforma-abierta-multimodal-con-informacion-y-servicios-de-movilidad-medida-3-3-/?vgnextfmt=default&amp;vgnextoid=a0aab0cb9959f510VgnVCM2000001f4a900aRCRD&amp;vgnextchannel=a92192f14e69f510VgnVCM1000001d4a900aRCRD#" target="_blank" rel="noreferrer">Plataforma multimodal abierta para agosto de 2019</a></p></blockquote><p>Â¿Y que puedes sacar de este servicio?:</p><ul><li>Datos de las paradas, itinerarios, etc.</li><li>Datos GTFS.</li><li>Una pagina que no funciona para ver cuanto le queda al bus en tiempo real.</li></ul><h2 id="conclusion" tabindex="-1">ConclusiÃ³n <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;ConclusiÃ³n&quot;">â€‹</a></h2><p>Con esto ya tenemos toda la informacion necesaria para hacer una aplicaciÃ³n que:</p><ul><li>Muestre las paradas.</li><li>Te diga la caducidad del abono.</li><li>Te muestre los tiempos de espera.</li><li>Te muestre las localizaciones de los autobuses.</li><li>Te notifique el tiempo restante cada minuto.</li><li>Te avise sobre las posible incidencias que afectan a una parada, linea...</li></ul><p>Asi que aqui esta: <a href="https://www.madridtransporte.com/" target="_blank" rel="noreferrer">https://www.madridtransporte.com/</a></p><p>Puedes ver el codigo fuente aqui: <a href="https://github.com/xBaank/MadridTransporte" target="_blank" rel="noreferrer">https://github.com/xBaank/MadridTransporte</a></p><h3 id="version-play-store-de-acceso-cerrado" tabindex="-1">Version Play Store de acceso cerrado. <a class="header-anchor" href="#version-play-store-de-acceso-cerrado" aria-label="Permalink to &quot;Version Play Store de acceso cerrado.&quot;">â€‹</a></h3><p>Si quieres descargarlo desde Play Store necesitas unirte a este grupo de google: <a href="https://groups.google.com/g/testing-madrid-transporte" target="_blank" rel="noreferrer">https://groups.google.com/g/testing-madrid-transporte</a></p><p>Descargar la app: <a href="https://play.google.com/store/apps/details?id=com.madridtransporte" target="_blank" rel="noreferrer">https://play.google.com/store/apps/details?id=com.madridtransporte</a></p>`,80)]))}const b=a(E,[["render",u]]);export{C as __pageData,b as default};
